---
import { endpoints } from "../modules/getEndpoints";
import Anchor from "./core/Anchor.astro";

// ìˆ«ìë¡œ ëë‚˜ëŠ” ì£¼ì œë³„ ì²« í˜ì´ì§€ë§Œ í•„í„°ë§ & ì¤‘ë³µ ì œê±°
const uniqueSubjects = new Set();
const filteredEndpoints = endpoints.filter((endpoint) => {
  // ìˆ«ìê°€ ì•„ë‹Œ IDëŠ” í•­ìƒ í¬í•¨ (ì˜ˆ: 't3')
  if (isNaN(Number(endpoint.id))) {
    return true;
  }

  // ìˆ«ìì¸ ê²½ìš° ê° ì£¼ì œì˜ ì²« ë²ˆì§¸ í˜ì´ì§€ë§Œ í¬í•¨
  if (!uniqueSubjects.has(endpoint.subject) && endpoint.id === "1") {
    uniqueSubjects.add(endpoint.subject);
    return true;
  }

  return false;
});
---

<div id='main-nav' class='container'>
  <ul>
    <li>
      <Anchor href='/' text='ğŸ ' />
    </li>
    {
      filteredEndpoints.map((endpoint) => (
        <li>
          <Anchor
            href={`/${endpoint.subject}/${endpoint.id}`}
            text={`${endpoint.subject} ${!isNaN(Number(endpoint.id)) ? "" : endpoint.id}`}
          />
        </li>
      ))
    }
  </ul>
</div>

<style>
  .container {
    display: flex;
    background-color: #fff;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    transition:
      transform 0.3s ease-in-out,
      opacity 0.2s ease-in-out;
    transform-origin: top;

    max-width: 1200px;
    padding: 0.25rem 1rem;
  }

  ul {
    display: flex;
    gap: 1.5rem;
    list-style: none;
  }

  ul li {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .nav-hidden {
    transform: scaleY(0);
    transform-origin: top;
    opacity: 0;
    transition:
      transform 0.3s ease,
      opacity 0.2s ease;
  }
</style>

<script>
  // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ì²˜ë¦¬ë¥¼ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸
  let lastScrollY = window.scrollY;
  const nav = document.getElementById("main-nav");

  window.addEventListener("scroll", () => {
    const currentScrollY = window.scrollY;

    // ìŠ¤í¬ë¡¤ ë°©í–¥ ê°ì§€
    if (currentScrollY > lastScrollY) {
      // ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤: ë„¤ë¹„ê²Œì´ì…˜ ìˆ¨ê¸°ê¸°
      nav!.classList.add("nav-hidden");
    } else {
      // ìœ„ë¡œ ìŠ¤í¬ë¡¤: ë„¤ë¹„ê²Œì´ì…˜ í‘œì‹œ
      nav!.classList.remove("nav-hidden");
    }

    lastScrollY = currentScrollY;
  });
</script>
